version: "3"

vars:
  PODMAN_VERSION: "4.8.2"


tasks:
  installBasics:
    cmds:
      - sudo apt-get update
      - sudo apt-get -y install nano unzip
  removebasics:
    interactive: true
    cmds:
      - sudo apt-get remove nano unzip
      - sudo apt autoremove

  installPodman:
    deps: [ installBasics ]
    cmds:
      - wget https://github.com/containers/podman/releases/download/v4.8.2/podman-remote-release-darwin_amd64.zip -O /tmp/podman.zip
      - defer: rm -f /tmp/podman.zip
      - unzip /tmp/podman.zip -d /tmp
      - defer: rm -rf /tmp/podman
      - sudo mv /tmp/podman-{{.PODMAN_VERSION}}/usr/bin/podman /usr/bin/podman
  removePodman:
    cmds:
      - sudo rm /usr/bin/podman
  updatePodman:
    cmds:
      - task: removePodman
      - task: installPodman